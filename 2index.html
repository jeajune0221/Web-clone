<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ì¬ì¤€ì˜ Notion</title>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <link rel="stylesheet" href="2style.css" />
</head>
<body>
  <div class="sid">
    <div class="sid-header">
      <div class="workspace-selector">
        <div class="workspace-icon">ì¬</div>
        <div>
          <div style="font-size: 14px; font-weight: 600;">ì¬ì¤€ì˜ Notion</div>
          <div style="font-size: 12px; color: #999;">ê°œì¸ ì›Œí¬ìŠ¤í˜ì´ìŠ¤</div>
        </div>
      </div>
    </div>

    <div class="search-box">
      <input type="text" class="search-input" placeholder="ê²€ìƒ‰" id="searchInput">
      <div class="search-icon">ğŸ”</div>
    </div>

    <div class="sid-content">
      <div class="nav-section">
        <div class="nav-item active" id="searchNav" onclick="showSearch()">
          <div class="nav-item-icon">ğŸ”</div>
          <span>ê²€ìƒ‰</span>
        </div>
        <div class="nav-item" id="updatesNav" onclick="showUpdates()">
          <div class="nav-item-icon">ğŸ””</div>
          <span>ì—…ë°ì´íŠ¸</span>
        </div>
        <div class="nav-item" id="allUpdatesNav" onclick="showAllUpdates()">
          <div class="nav-item-icon">ğŸ•’</div>
          <span>ëª¨ë“  ì—…ë°ì´íŠ¸</span>
        </div>
        <div class="nav-item" id="inboxNav" onclick="showInbox()">
          <div class="nav-item-icon">âœ‰ï¸</div>
          <span>ë°›ì€ í¸ì§€í•¨</span>
        </div>
      </div>

      <div class="pages-section">
        <div class="pages-header">
          <div class="pages-title">ê°œì¸ í˜ì´ì§€</div>
          <button class="add-page-btn" onclick="showNewPageModal()">+</button>
        </div>
        <div id="pagesList">
        </div>
      </div>
    </div>

    <div class="sid-footer">
      <div class="user-profile">
        <div class="user-avatar">ì¬</div>
        <div>
          <div style="font-size: 14px;">ì¬ì¤€</div>
          <div style="font-size: 12px; color: #999;">ë©¤ë²„ ì´ˆëŒ€</div>
        </div>
      </div>
    </div>
  </div>

  <div class="main">
    <div class="main-header">
      <div class="breadcrumb">
        <span id="breadcrumbText">ğŸ” ê²€ìƒ‰</span>
      </div>
      <div class="header-actions">
        <button class="action-btn" id="favoriteBtn" onclick="toggleFavorite()">â­</button>
        <button class="action-btn" onclick="shareCurrentPage()">ğŸ“¤</button>
        <div class="dropdown">
          <button class="action-btn">âš™ï¸</button>
          <div class="dropdown-content">
            <a href="#" onclick="duplicatePage()">í˜ì´ì§€ ë³µì œ</a>
            <a href="#" onclick="deletePage()">í˜ì´ì§€ ì‚­ì œ</a>
            <a href="#" onclick="exportPage()">ë‚´ë³´ë‚´ê¸°</a>
          </div>
        </div>
      </div>
    </div>

    <div class="main-content" id="mainContent">
    </div>
  </div>

  <div id="newPageModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">ìƒˆ í˜ì´ì§€ ë§Œë“¤ê¸°</h3>
        <button class="modal-close" onclick="hideNewPageModal()">Ã—</button>
      </div>
      <input type="text" class="modal-input" placeholder="í˜ì´ì§€ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”" id="newPageTitle">
      <div class="modal-actions">
        <button class="modal-btn secondary" onclick="hideNewPageModal()">ì·¨ì†Œ</button>
        <button class="modal-btn primary" onclick="createNewPageFromModal()">ë§Œë“¤ê¸°</button>
      </div>
    </div>
  </div>

  <div id="autocom-container" class="autocom-list" style="display: none;"></div>

  <script>
    const commands = [
      { trigger: '/h1', insert: '# ', description: 'í—¤ë”1' },
      { trigger: '/h2', insert: '## ', description: 'í—¤ë”2' },
      { trigger: '/h3', insert: '### ', description: 'í—¤ë”3' },
      { trigger: '/ul', insert: '- ', description: 'ë¦¬ìŠ¤íŠ¸' },
      { trigger: '/ol', insert: '1. ', description: 'ìˆ«ì ë¦¬ìŠ¤íŠ¸' },
      { trigger: '/quote', insert: '> ', description: 'ì¸ìš©' },
      { trigger: '/code', insert: '```', description: 'ì½”ë“œ ë¸”ë¡' },
      { trigger: '/link', insert: '[text](url)', description: 'ë§í¬' },
      { trigger: '/toggle', insert: '<details><summary>Title</summary>Content</details>', description: 'í† ê¸€' }
    ];

    let currentPage = null;
    let currentView = 'search';
    let recentPages = [];
    let pages = {
      'ìƒˆ í˜ì´ì§€': { title: 'ìƒˆ í˜ì´ì§€', icon: 'ğŸ“„', content: '', favorite: false, lastModified: new Date() }
    };

    function init() {
      updatePagesList();
      showSearch();
      setupSearchFunction();
      setupKeyboardShortcuts();
      setupModalEnterKey();
    }

    function updatePagesList() {
      const pagesList = document.getElementById('pagesList');
      pagesList.innerHTML = '';
      
      Object.keys(pages).forEach(key => {
        const page = pages[key];
        const pageItem = document.createElement('div');
        pageItem.className = 'page-item';
        pageItem.innerHTML = `
          <div class="page-icon">${page.icon}</div>
          <span>${page.title}</span>
          <div class="page-item-actions">
            <button class="page-action-btn favorite-btn ${page.favorite ? 'active' : ''}" onclick="togglePageFavorite('${key}')">â­</button>
            <button class="page-action-btn" onclick="deletePageConfirm('${key}')">ğŸ—‘ï¸</button>
          </div>
        `;
        pageItem.onclick = (e) => {
          if (!e.target.classList.contains('page-action-btn')) {
            loadPage(key);
          }
        };
        pagesList.appendChild(pageItem);
      });
    }

    function showSearch() {
      currentView = 'search';
      updateActiveNavItem('searchNav');
      document.getElementById('breadcrumbText').textContent = 'ğŸ” ê²€ìƒ‰';
      document.getElementById('favoriteBtn').style.display = 'none';
      
      document.getElementById('mainContent').innerHTML = `
        <div class="welcome-section">
          <div class="welcome-icon">ğŸ‘‹</div>
          <h1 class="welcome-title">ì•ˆë…•í•˜ì„¸ìš”.</h1>
          <p class="welcome-subtitle">ì›Œí¬ìŠ¤í˜ì´ìŠ¤ì—ì„œ ë¬´ì—‡ì´ë“ ì§ˆë¬¸í•˜ê±°ë‚˜ ì°¾ì•„ë³´ì„¸ìš”...</p>
          
          <div class="quick-actions">
            <button class="quick-action" onclick="showTemplates()">
              <span>âœï¸</span>
              <span>ì§ˆë¬¸</span>
            </button>
            <button class="quick-action" onclick="showTemplates()">
              <span>ğŸ“‹</span>
              <span>ë¦¬ì„œì¹˜</span>
            </button>
            <button class="quick-action" onclick="showTemplates()">
              <span>ğŸ—‚ï¸</span>
              <span>ë§Œë“¤ê¸°</span>
            </button>
          </div>

          <div class="templates-section">
            <h3 class="templates-title">ë¹ ë¥¸ ë°©ë²•</h3>
            <div class="templates-grid">
              <div class="template-card" onclick="loadPage('ìƒˆ í˜ì´ì§€')">
                <div class="template-icon">ğŸ“„</div>
                <div class="template-title">ìƒˆ í˜ì´ì§€</div>
                <div class="template-description">ë¹ˆ í˜ì´ì§€ë¡œ ì‹œì‘í•˜ê¸°</div>
              </div>
              <div class="template-card" onclick="showTemplates()">
                <div class="template-icon">ğŸ”¬</div>
                <div class="template-title">ê³¼í•™ í”„ë¡œì íŠ¸</div>
                <div class="template-description">ì‹¤í—˜ ê¸°ë¡ ë° ë¶„ì„</div>
              </div>
              <div class="template-card" onclick="showTemplates()">
                <div class="template-icon">ğŸ†</div>
                <div class="template-title">í•´ì»¤í†¤</div>
                <div class="template-description">í”„ë¡œì íŠ¸ ê³„íš ìˆ˜ë¦½</div>
              </div>
            </div>
          </div>

          <div class="recent-section">
            <h3 class="recent-title">ìµœê·¼ ì—´ëŒ</h3>
            <div class="recent-grid" id="recentGrid">
            </div>
          </div>
        </div>
      `;
      updateRecentSection();
    }

    function showUpdates() {
      currentView = 'updates';
      updateActiveNavItem('updatesNav');
      document.getElementById('breadcrumbText').textContent = 'ğŸ”” ì—…ë°ì´íŠ¸';
      document.getElementById('favoriteBtn').style.display = 'none';

      document.getElementById('mainContent').innerHTML = `
        <div class="empty-state">
          <div class="empty-state-icon">ğŸ””</div>
          <div class="empty-state-title">ì—…ë°ì´íŠ¸ ì—†ìŒ</div>
          <div class="empty-state-description">ìµœì‹  ì—…ë°ì´íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.</div>
        </div>
      `;
    }

    function showAllUpdates() {
      currentView = 'allUpdates';
      updateActiveNavItem('allUpdatesNav');
      document.getElementById('breadcrumbText').textContent = 'ğŸ•’ ëª¨ë“  ì—…ë°ì´íŠ¸';
      document.getElementById('favoriteBtn').style.display = 'none';

      const sortedPages = Object.keys(pages).sort((a, b) => pages[b].lastModified - pages[a].lastModified).slice(0, 5);
      const content = sortedPages.length > 0 ? `
        <div class="recent-section">
          <h3 class="recent-title">ëª¨ë“  ì—…ë°ì´íŠ¸</h3>
          <div class="recent-grid">
            ${sortedPages.map(key => `
              <div class="recent-card" onclick="loadPage('${key}')">
                <div class="recent-card-title">${pages[key].title}</div>
                <div class="recent-card-meta">ë§ˆì§€ë§‰ ìˆ˜ì •: ${pages[key].lastModified.toLocaleDateString()}</div>
              </div>
            `).join('')}
          </div>
        </div>
      ` : `
        <div class="empty-state">
          <div class="empty-state-icon">ğŸ•’</div>
          <div class="empty-state-title">ì—…ë°ì´íŠ¸ ì—†ìŒ</div>
          <div class="empty-state-description">í˜ì´ì§€ê°€ ìˆ˜ì •ë˜ë©´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</div>
        </div>
      `;
      document.getElementById('mainContent').innerHTML = content;
    }

    function showInbox() {
      currentView = 'inbox';
      updateActiveNavItem('inboxNav');
      document.getElementById('breadcrumbText').textContent = 'âœ‰ï¸ ë°›ì€ í¸ì§€í•¨';
      document.getElementById('favoriteBtn').style.display = 'none';

      document.getElementById('mainContent').innerHTML = `
        <div class="empty-state">
          <div class="empty-state-icon">âœ‰ï¸</div>
          <div class="empty-state-title">ë©”ì‹œì§€ ì—†ìŒ</div>
          <div class="empty-state-description">ìƒˆë¡œìš´ ë©”ì‹œì§€ê°€ ì—†ìŠµë‹ˆë‹¤.</div>
        </div>
      `;
    }

    function showTemplates() {
      alert("ê·¸ ê¸°ëŠ¥ì„ ì•„ì§ êµ¬í˜„ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
    }

    function showDatabase() {
      currentView = 'database';
      updateActiveNavItem(null);
      document.getElementById('breadcrumbText').textContent = 'ğŸ—‚ï¸ ë°ì´í„°ë² ì´ìŠ¤';
      document.getElementById('favoriteBtn').style.display = 'none';

      document.getElementById('mainContent').innerHTML = `
        <div class="empty-state">
          <div class="empty-state-icon">ğŸ—‚ï¸</div>
          <div class="empty-state-title">ë°ì´í„°ë² ì´ìŠ¤ ì—†ìŒ</div>
          <div class="empty-state-description">ìƒˆë¡œìš´ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ë§Œë“¤ì–´ë³´ì„¸ìš”.</div>
        </div>
      `;
    }

    function loadPage(key) {
      if (!pages[key]) {
        console.error(`Page "${key}" not found`);
        showSearch();
        return;
      }
      currentPage = key;
      currentView = 'page';
      updateActiveNavItem(null);
      document.getElementById('breadcrumbText').textContent = `${pages[key].icon} ${pages[key].title}`;
      document.getElementById('favoriteBtn').style.display = 'inline-block';
      document.getElementById('favoriteBtn').classList.toggle('active', pages[key].favorite);

      recentPages = recentPages.filter(p => p !== key);
      recentPages.unshift(key);
      if (recentPages.length > 5) recentPages.pop();

      document.getElementById('mainContent').innerHTML = `
        <div class="page-content">
          <h1 class="page-title" contenteditable="true" oninput="updatePageTitle('${key}', this.textContent)">${pages[key].title}</h1>
          <textarea class="page-editor" id="markdown-input" oninput="updatePageContent('${key}', this.value); renderMarkdown();">${pages[key].content}</textarea>
          <div class="markdown-preview" id="markdown-preview"></div>
        </div>
      `;

      const inputElement = document.getElementById('markdown-input');
      inputElement.addEventListener('input', (e) => {
        const cursorPosition = inputElement.selectionStart;
        const textBeforeCursor = inputElement.value.substring(0, cursorPosition);
        const lastSlashIndex = textBeforeCursor.lastIndexOf('/');
        if (lastSlashIndex >= 0 && cursorPosition - lastSlashIndex <= inputElement.value.substring(lastSlashIndex).split(' ')[0].length + 1) {
          const commandText = inputElement.value.substring(lastSlashIndex, cursorPosition);
          showautocomList(commandText, inputElement);
        } else {
          document.getElementById('autocom-container').style.display = 'none';
        }
        renderMarkdown();
      });

      renderMarkdown();
    }

    function renderMarkdown() {
      const markdownInput = document.getElementById('markdown-input');
      if (!markdownInput) {
        console.warn('Markdown input element not found');
        return;
      }
      const markdownText = markdownInput.value || '';
      const htmlContent = marked.parse(markdownText, { breaks: true, gfm: true, sanitize: true });
      const preview = document.getElementById('markdown-preview');
      if (preview) {
        preview.innerHTML = htmlContent;
      }
    }

    function updateRecentSection() {
      const recentGrid = document.getElementById('recentGrid');
      if (recentGrid) {
        recentGrid.innerHTML = recentPages.length > 0 ? recentPages.map(key => `
          <div class="recent-card" onclick="loadPage('${key}')">
            <div class="recent-card-title">${pages[key].title}</div>
            <div class="recent-card-meta">ë§ˆì§€ë§‰ ìˆ˜ì •: ${pages[key].lastModified.toLocaleDateString()}</div>
          </div>
        `).join('') : `
          <div class="empty-state">
            <div class="empty-state-icon">ğŸ•’</div>
            <div class="empty-state-title">ìµœê·¼ í˜ì´ì§€ ì—†ìŒ</div>
            <div class="empty-state-description">í˜ì´ì§€ë¥¼ ì—´ì–´ë³´ì„¸ìš”.</div>
          </div>
        `;
      }
    }

    function showautocomList(inputText, inputElement) {
      const matchingCommands = commands.filter(cmd => cmd.trigger.toLowerCase().startsWith(inputText.toLowerCase()));
      const autocomContainer = document.getElementById('autocom-container');
      
      if (matchingCommands.length === 0 || inputText.length < 1) {
        autocomContainer.style.display = 'none';
        return;
      }
      
      autocomContainer.innerHTML = matchingCommands.map(cmd => 
        `<div class="autocom-item" onclick="insertCommand('${cmd.insert}')">${cmd.description}</div>`
      ).join('');
      
      const rect = inputElement.getBoundingClientRect();
      const lineHeight = parseInt(window.getComputedStyle(inputElement).lineHeight) || 20;
      const lines = inputElement.value.substring(0, inputElement.selectionStart).split('\n');
      const currentLine = lines.length - 1;
      const topOffset = rect.top + (currentLine * lineHeight) + lineHeight;
      const leftOffset = rect.left;

      autocomContainer.style.top = `${topOffset}px`;
      autocomContainer.style.left = `${leftOffset}px`;
      autocomContainer.style.display = 'block';
    }

    function insertCommand(insertText) {
      const inputElement = document.getElementById('markdown-input');
      const cursorPosition = inputElement.selectionStart;
      const textBefore = inputElement.value.substring(0, cursorPosition).replace(/\/[^\/\s]*$/, '');
      const textAfter = inputElement.value.substring(cursorPosition);
      inputElement.value = `${textBefore}${insertText}${textAfter}`;
      const newPosition = textBefore.length + insertText.length;
      inputElement.setSelectionRange(newPosition, newPosition);
      document.getElementById('autocom-container').style.display = 'none';
      renderMarkdown();
    }

    function updatePageTitle(key, title) {
      pages[key].title = title.trim() || 'ì œëª© ì—†ìŒ';
      pages[key].lastModified = new Date();
      updatePagesList();
    }

    function updatePageContent(key, content) {
      pages[key].content = content;
      pages[key].lastModified = new Date();
    }

    function togglePageFavorite(key) {
      pages[key].favorite = !pages[key].favorite;
      updatePagesList();
      if (currentPage === key) {
        document.getElementById('favoriteBtn').classList.toggle('active', pages[key].favorite);
      }
    }

    function toggleFavorite() {
      if (currentPage) {
        togglePageFavorite(currentPage);
      }
    }

    function showNewPageModal() {
      document.getElementById('newPageModal').style.display = 'block';
      document.getElementById('newPageTitle').value = '';
      document.getElementById('newPageTitle').focus();
    }

    function hideNewPageModal() {
      document.getElementById('newPageModal').style.display = 'none';
    }

    function createNewPageFromModal() {
      const title = document.getElementById('newPageTitle').value.trim();
      if (!title) {
        alert('í˜ì´ì§€ ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
      }
      

      if (pages[title]) {
        alert('ê°™ì€ ì´ë¦„ì˜ í˜ì´ì§€ê°€ ì´ë¯¸ ì¡´ì¬í•©ë‹ˆë‹¤.');
        return;
      }
      

      pages[title] = {
        title: title,
        icon: 'ğŸ“„',
        content: '',
        favorite: false,
        lastModified: new Date()
      };
      
      hideNewPageModal();
      updatePagesList();
      loadPage(title);
    }

    function deletePageConfirm(key) {
      if (confirm(`"${pages[key].title}" í˜ì´ì§€ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
        delete pages[key];
        updatePagesList();
        if (currentPage === key) showSearch();
      }
    }

    function updateActiveNavItem(activeId) {
      document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
      if (activeId) document.getElementById(activeId).classList.add('active');
    }

    function setupSearchFunction() {
      document.getElementById('searchInput').addEventListener('input', (e) => {
        const query = e.target.value.toLowerCase();
        const filteredPages = Object.keys(pages).filter(key => 
          key.toLowerCase().includes(query) || pages[key].content.toLowerCase().includes(query)
        );
        const pagesList = document.getElementById('pagesList');
        pagesList.innerHTML = filteredPages.map(key => `
          <div class="page-item" onclick="loadPage('${key}')">
            <div class="page-icon">${pages[key].icon}</div>
            <span>${pages[key].title}</span>
          </div>
        `).join('');
      });
    }

    function setupKeyboardShortcuts() {
      document.addEventListener('keydown', (e) => {
        if (e.key === 'n' && e.ctrlKey) {
          e.preventDefault();
          showNewPageModal();
        }
        if (e.key === 'Escape') {
          hideNewPageModal();
        }
      });
    }

    function setupModalEnterKey() {
      document.getElementById('newPageTitle').addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
          e.preventDefault();
          createNewPageFromModal();
        }
      });
    }

    function shareCurrentPage() {
      alert('í˜ì´ì§€ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤: ' + window.location.href + '/' + currentPage);
    }

    function duplicatePage() {
      if (!currentPage) return;
      
      let newTitle = `${pages[currentPage].title} (ë³µì‚¬)`;
      let counter = 1;
      

      while (pages[newTitle]) {
        counter++;
        newTitle = `${pages[currentPage].title} (ë³µì‚¬${counter})`;
      }
      
      pages[newTitle] = { 
        ...pages[currentPage], 
        title: newTitle, 
        lastModified: new Date() 
      };
      updatePagesList();
      loadPage(newTitle);
    }

    function deletePage() {
      if (currentPage) {
        deletePageConfirm(currentPage);
      }
    }

    function exportPage() {
      if (!currentPage) return;
      
      const content = pages[currentPage].content;
      const blob = new Blob([content], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `${pages[currentPage].title}.md`;
      a.click();
      URL.revokeObjectURL(url);
    }

    init();
  </script>
</body>
</html>